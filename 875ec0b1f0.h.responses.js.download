'https://github.com/swmff/rainbeam';function asyncGeneratorStep(e,n,t,s,r,o,c){try{var i=e[o](c),a=i.value}catch(e){t(e);return}i.done?n(a):Promise.resolve(a).then(s,r)}function _async_to_generator(e){return function(){var n=this,t=arguments;return new Promise(function(s,r){var o=e.apply(n,t);function c(e){asyncGeneratorStep(o,s,r,c,i,"next",e)}function i(e){asyncGeneratorStep(o,s,r,c,i,"throw",e)}c(void 0)})}}function _ts_generator(e,n){var t,s,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(t)throw TypeError("Generator is already executing.");for(;c;)try{if(t=1,s&&(r=2&o[0]?s.return:o[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,o[1])).done)return r;switch(s=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,s=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){c.label=o[1];break}if(6===o[0]&&c.label<r[1]){c.label=r[1],r=o;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(o);break}r[2]&&c.ops.pop(),c.trys.pop();continue}o=n.call(e,c)}catch(e){o=[6,e],s=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}!function(){var e,n,t,s=reg_ns("responses",["app"]);s.define("create",(e=_async_to_generator(function(e,n,t){var s,r,o,c,i,a,u=arguments;return _ts_generator(this,function(p){switch(p.label){case 0:return e.$,s=e.app,r=u.length>3&&void 0!==u[3]?u[3]:"",o=u.length>4&&void 0!==u[4]?u[4]:"",c=u.length>5&&void 0!==u[5]?u[5]:"",i=u.length>6&&void 0!==u[6]&&u[6],a=u.length>7&&void 0!==u[7]?u[7]:"",[4,s.debounce("responses::create")];case 1:return p.sent(),r||(r=""),[2,new Promise(function(e,u){fetch("/api/v1/responses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n,content:t,tags:""===r?[]:r.split(",").map(function(e){return e.trim()}),warning:o||"",reply:c||"",unlisted:i||!1,circle:a||""})}).then(function(e){return e.json()}).then(function(t){return!1===t.success?(s.toast("error",t.message),u(t)):("0"!==n&&s.smooth_remove(document.getElementById("question:".concat(n)),500),e(t))})})]}})}),function(n,t,s){return e.apply(this,arguments)})),s.define("edit",function(e,n,t){e.$;var s=e.app;return new Promise(function(e,r){fetch("/api/v1/responses/".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t})}).then(function(e){return e.json()}).then(function(n){return(s.toast(n.success?"success":"error",n.success?"Response edited!":n.message),!0===n.success)?e(n):r(n)})})}),s.define("edit_tags",function(e,n,t){e.$;var s=e.app;return new Promise(function(e,r){fetch("/api/v1/responses/".concat(n,"/tags"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tags:t})}).then(function(e){return e.json()}).then(function(n){return(s.toast(n.success?"success":"error",n.success?"Response edited!":n.message),!0===n.success)?e(n):r(n)})})}),s.define("edit_context",function(e,n,t){e.$;var s=e.app;return new Promise(function(e,r){fetch("/api/v1/responses/".concat(n,"/context"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:t})}).then(function(e){return e.json()}).then(function(n){return(s.toast(n.success?"success":"error",n.success?"Response edited!":n.message),!0===n.success)?e(n):r(n)})})}),s.define("edit_context_warning",function(e,n,t){e.$;var s=e.app;return new Promise(function(e,r){fetch("/api/v1/responses/".concat(n,"/context/warning"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({warning:t})}).then(function(e){return e.json()}).then(function(n){return(s.toast(n.success?"success":"error",n.success?"Response edited!":n.message),!0===n.success)?e(n):r(n)})})}),s.define("delete",(n=_async_to_generator(function(e,n){var t;return _ts_generator(this,function(s){switch(s.label){case 0:return e.$,t=e.app,[4,trigger("app::confirm",["Are you sure you want to do this? This will delete the response and its question."])];case 1:if(!s.sent())return[2];return fetch("/api/v1/responses/".concat(n),{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){t.toast(e.success?"success":"error",e.success?"Response deleted!":e.message),t.smooth_remove(document.getElementById("response:".concat(n)),500)}),[2]}})}),function(e,t){return n.apply(this,arguments)})),s.define("unsend",(t=_async_to_generator(function(e,n){var t;return _ts_generator(this,function(s){switch(s.label){case 0:return e.$,t=e.app,[4,trigger("app::confirm",["Are you sure you want to do this? This will delete the response and allow you to answer the question again."])];case 1:if(!s.sent())return[2];return fetch("/api/v1/responses/".concat(n,"/unsend"),{method:"POST"}).then(function(e){return e.json()}).then(function(e){t.toast(e.success?"success":"error",e.success?"Question returned to inbox!":e.message),t.smooth_remove(document.getElementById("response:".concat(n)),500)}),[2]}})}),function(e,n){return t.apply(this,arguments)})),s.define("gen_share",function(e,n,t,s,r){for(var o=globalThis.__user.metadata.kv["rainbeam:share_hashtag"]||"";!n.classList.contains("response");)n=n.parentElement;var c=(n.querySelector(".question_content p:first-child")||{innerText:""}).innerText,i=n.querySelector(".response_content:not(include-partial *) p").innerText,a=!1!==r?"".concat(window.location.origin,"/+r/").concat(t):"";s-=a.length;var u="",p=" â€” ",l=s/2-1,f=s/2-p.length;return o&&(u+="#".concat(o)),""!==c&&(u+=f>c.length?c:c.substring(0,f),u+=p),""!==i&&(u+=l>i.length?i:i.substring(0,l)),u+=" ".concat(a)}),s.define("click",function(e,n,t){trigger("app::hooks::dropdown.close");var s=document.querySelector("#response\\:".concat(n," .response_warning"));if(s){var r=document.querySelector("#response\\:".concat(n," .response_content")),o=document.querySelector("#response\\:".concat(n," .question"));o&&o.classList.remove("hidden"),r.classList.remove("hidden"),s.classList.add("hidden")}if(!t){window.location.href="/response/".concat(n);return}})}();