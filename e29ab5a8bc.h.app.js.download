'https://github.com/swmff/rainbeam';function asyncGeneratorStep(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){n(e);return}l.done?t(c):Promise.resolve(c).then(r,o)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,l,"next",e)}function l(e){asyncGeneratorStep(a,r,o,i,l,"throw",e)}i(void 0)})}}function _ts_generator(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}!function(){var e,t,n,r=reg_ns("app");r.USE_TENNIS_LOADER=!0,r.DEBOUNCE=[],r.OBSERVERS=[],r.define("try_use",function(e,t,n){if(globalThis._app_base.ns_store["$".concat(t)])return n(globalThis._app_base.ns_store["$".concat(t)]);use(t,n)}),r.define("debounce",function(e,t){var n=e.$;return new Promise(function(e,r){return n.DEBOUNCE.includes(t)?r():(n.DEBOUNCE.push(t),setTimeout(function(){delete n.DEBOUNCE[n.DEBOUNCE.indexOf(t)]},1e3),e())})}),r.define("rel_date",function(e,t){var n=(new Date().getTime()-t.getTime())/1e3,r=Math.floor(n/86400);if(!Number.isNaN(r)&&!(r<0)&&!(r>=31))return 0===r&&(n<60&&"just now"||n<120&&"1 minute ago"||n<3600&&Math.floor(n/60)+" minutes ago"||n<7200&&"1 hour ago"||n<86400&&Math.floor(n/3600)+" hours ago")||1===r&&"Yesterday"||r<7&&r+" days ago"||r<31&&Math.ceil(r/7)+" weeks ago"}),r.define("clean_date_codes",function(e){var t=e.$,n=!0,r=!1,o=void 0;try{for(var a,i=Array.from(document.querySelectorAll(".date"))[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;l.getAttribute("data-unix")&&(l.innerText=l.getAttribute("data-unix")),l.setAttribute("data-unix",l.innerText);var c=new Date(Number.parseInt(l.innerText));if(!Number.isNaN(l.innerText)){l.setAttribute("title",c.toLocaleString());var s=t.rel_date(c);screen.width<900&&void 0!==s&&(s=s.replaceAll(" minutes ago","m").replaceAll(" minute ago","m").replaceAll(" hours ago","h").replaceAll(" hour ago","h").replaceAll(" days ago","d").replaceAll(" day ago","d").replaceAll(" weeks ago","w").replaceAll(" week ago","w").replaceAll(" months ago","m").replaceAll(" month ago","m").replaceAll(" years ago","y").replaceAll(" year ago","y")),l.innerText=void 0===s?c.toLocaleDateString():s,l.style.display="inline-block"}}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}}),r.define("ipblock",(e=_async_to_generator(function(e,t){return _ts_generator(this,function(n){switch(n.label){case 0:return e.$,[4,trigger("app::confirm",["Are you sure you want to do this?"])];case 1:if(!n.sent())return[2];return fetch("/api/v1/profiles/".concat(t,"/ipblock"),{method:"POST"}).then(function(e){return e.json()}).then(function(e){r.toast(e.success?"success":"error",e.success?"IP blocked!":e.message)}),[2]}})}),function(t,n){return e.apply(this,arguments)})),r.define("icon",(t=_async_to_generator(function(e,t){var n,r,o,a,i,l,c=arguments;return _ts_generator(this,function(s){switch(s.label){case 0:if(n=e.$,r=c.length>2&&void 0!==c[2]?c[2]:"",o=c.length>3&&void 0!==c[3]?c[3]:"",n.ICONS||(n.ICONS={}),n.ICONS[t])return(a=new DOMParser().parseFromString(n.ICONS[t],"text/xml").firstChild).setAttribute("class",r),a.setAttribute("style",o),[2,a];return[4,fetch("/static/build/icons/".concat(t,".svg"))];case 1:return[4,s.sent().text()];case 2:return i=s.sent(),n.ICONS[t]=i,(l=new DOMParser().parseFromString(i,"text/xml").firstChild).setAttribute("class",r),l.setAttribute("style",o),[2,l]}})}),function(e,n){return t.apply(this,arguments)})),r.define("copy_text",function(e,t){var n=e.$;navigator.clipboard.writeText(t),n.toast("success","Copied!")}),r.define("intent_twitter",function(e,t,n){var r=e.$;window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(t),"&url=").concat(encodeURIComponent(n))),r.toast("success","Opened intent!")}),r.define("intent_bluesky",function(e,t,n){var r=e.$;t+=" ".concat(n),window.open("https://bsky.app/intent/compose?text=".concat(encodeURIComponent(t))),r.toast("success","Opened intent!")}),r.define("smooth_remove",function(e,t,n){t.style.animation="fadeout ease-in-out 1 ".concat(n,"ms forwards running"),setTimeout(function(){t.remove()},n)}),r.define("ban_ip",function(e,t){var n=prompt("Please explain your reason for banning this IP below:");n&&fetch("/api/v0/auth/ipbans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:t,reason:n})}).then(function(e){return e.json()}).then(function(e){trigger("app::toast",[e.success?"success":"error",e.message||"IP banned!"])})}),r.define("disconnect_observers",function(e){var t=e.$,n=!0,r=!1,o=void 0;try{for(var a,i=t.OBSERVERS[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)a.value.disconnect()}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}t.OBSERVERS=[]}),r.define("offload_work_to_client_when_in_view",function(e,t){var n=[];return new IntersectionObserver(function(e){var r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var c=i.value,s=c.target;!c.isIntersecting||n.includes(s)||(n.push(s),t(s))}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}},{root:document.body,rootMargin:"0px",threshold:1})}),r.define("toggle_flex",function(e,t){"none"===t.style.display?t.style.display="flex":t.style.display="none"}),r.define("hooks::scroll",function(e,t,n){var r=[150,250,500,1e3];n.setAttribute("data-scroll","0"),t.addEventListener("scroll",function(e){n.setAttribute("data-scroll",t.scrollTop);var o=!0,a=!1,i=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var s=l.value,u="data-scroll-".concat(s);t.scrollTop>=s?n.setAttribute(u,"true"):n.removeAttribute(u)}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}})}),r.define("hooks::dropdown.close",function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=Array.from(document.querySelectorAll(".inner.open"))[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)o.value.classList.remove("open")}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}),r.define("hooks::dropdown",function(e,t){var n=e.$;t.stopImmediatePropagation();for(var r=t.target;!r.matches(".dropdown");)r=r.parentElement;n["hooks::dropdown.close"](),setTimeout(function(){var e=!0,t=!1,n=void 0;try{for(var o,a=Array.from(r.querySelectorAll(".inner"))[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){for(var i=o.value,l=r.getBoundingClientRect(),c=i.parentElement;!c.matches("html, .window");)c=c.parentElement;var s=c.getBoundingClientRect().y;"HTML"===c.nodeName&&(s=window.screen.height);var u=window.scrollY,d=s;l.y+u>d-u-300?i.classList.add("top"):i.classList.remove("top"),i.classList.add("open"),i.classList.contains("open")?i.removeAttribute("aria-hidden"):i.setAttribute("aria-hidden","true")}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}},5)}),r.define("hooks::dropdown.init",function(e,t){var n=!0,r=!1,o=void 0;try{for(var a,i=Array.from(document.querySelectorAll(".inner"))[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)a.value.setAttribute("aria-hidden","true")}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}t.addEventListener("click",function(e){if(!(e.target.matches(".dropdown")||e.target.matches("[exclude=dropdown]"))){var t=!0,n=!1,r=void 0;try{for(var o,a=Array.from(document.querySelectorAll(".inner.open"))[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)o.value.classList.remove("open")}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}})}),r.define("hooks::character_counter",function(e,t){for(var n=t.target;!n.matches("textarea, input");)n=n.parentElement;document.getElementById("".concat(n.id,":counter")).innerText="".concat(n.value.length,"/").concat(n.getAttribute("maxlength"))}),r.define("hooks::character_counter.init",function(e,t){var n=!0,o=!1,a=void 0;try{for(var i,l=Array.from(document.querySelectorAll("[hook=counter]")||[])[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var c=i.value;document.getElementById("".concat(c.id,":counter")).innerText="0/".concat(c.getAttribute("maxlength")),c.addEventListener("keyup",function(e){return r["hooks::character_counter"](e)})}}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}}),r.define("hooks::long",function(e,t,n){t.classList.remove("hook:long.hidden_text"),t.innerHTML=n}),r.define("hooks::long_text.init",function(e,t){var n=!0,o=!1,a=void 0;try{for(var i,l=Array.from(document.querySelectorAll("[hook=long]")||[])[Symbol.iterator]();!(n=(i=l.next()).done);n=!0)!function(){var e=i.value;if(e.innerText.length>=1024){e.classList.add("hook:long.hidden_text"),"lowered"===e.getAttribute("hook-arg")&&e.classList.add("hook:long.hidden_text+lowered");var t=e.innerHTML,n=t.slice(0,1024);e.innerHTML="".concat(n,"...");var o=function(){r["hooks::long"](e,t),e.removeEventListener("click",o)};e.addEventListener("click",o)}}()}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}}),r.define("hooks::alt",function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=Array.from(document.querySelectorAll("img")||[])[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;i.getAttribute("alt")&&!i.getAttribute("title")&&i.setAttribute("title",i.getAttribute("alt"))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}),r.define("hooks::ips",function(e){var t=e.$,n=!0,r=!1,o=void 0;try{for(var a,i=Array.from(document.querySelectorAll("a"))[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)!function(){var e=a.value;try{var n=new URL(e.href);n.pathname.startsWith("/+i/")&&e.addEventListener("click",function(e){e.preventDefault(),confirm('Would you like to ban this IP? Please press "Cancel" to open the first profile found with this IP instead of banning it.')?t.ban_ip(n.pathname.replace("/+i/","")):window.open(n.href,"_blank")})}catch(e){}}()}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}}),r.define("hooks::attach_to_partial",function(e,t,n,o,a,i,l){var c=e.$;return new Promise(function(e,l){function s(){return(s=_async_to_generator(function(){var r;return _ts_generator(this,function(l){var s;return r="".concat(t).concat(t.includes("?")?"&":"?","page=").concat(i),history.replaceState(history.state,"",r.replace(t,n)),fetch(r).then((s=_async_to_generator(function(t){var n;return _ts_generator(this,function(r){switch(r.label){case 0:return[4,t.text()];case 1:if((n=r.sent()).length<100||n.includes('data-marker="no-results"'))return a.removeEventListener("scroll",d),[2,e()];return o.innerHTML+=n,c.clean_date_codes(),c.link_filter(),c["hooks::alt"](),[2]}})}),function(e){return s.apply(this,arguments)})).catch(function(){a.removeEventListener("scroll",d),e()}),[2]})})).apply(this,arguments)}var u,d=(u=_async_to_generator(function(){return _ts_generator(this,function(e){return a.scrollTop+a.offsetHeight+100>o.offsetHeight&&r.debounce("app::partials").then(_async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:if(document.getElementById("initial_loader"))return console.log("partial blocked"),[2];return i+=1,[4,function(){return s.apply(this,arguments)}()];case 1:return e.sent(),[4,c["hooks::partial_embeds"]()];case 2:return e.sent(),[2]}})})).catch(function(){console.log("partial stuck")}),[2]})}),function(){return u.apply(this,arguments)});a.addEventListener("scroll",d)})}),r.define("hooks::partial_embeds",function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=Array.from(document.querySelectorAll("span[class] p"))[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value,l=/(\/\+r\/)([\w]+)/.exec(i.innerText);null!==l&&(i.innerText=i.innerText.replace(l[0],""),i.parentElement.innerHTML+='<include-partial\n                src="/_app/components/response.html?id='.concat(l[2],'&do_render_nested=false"\n                uses="app::clean_date_codes,app::link_filter,app::hooks::alt"\n            ></include-partial>'))}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}),r.define("hooks::check_reactions",(n=_async_to_generator(function(e){var t,n,r,o,a,i,l,c;return _ts_generator(this,function(s){var u;n=(t=e.$).offload_work_to_client_when_in_view((u=_async_to_generator(function(e){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,fetch("/api/v1/reactions/".concat(e.getAttribute("hook-arg:id")))];case 1:return[4,t.sent().json()];case 2:return t.sent().success&&(e.classList.add("green"),e.querySelector("svg").classList.add("filled")),[2]}})}),function(e){return u.apply(this,arguments)})),r=!0,o=!1,a=void 0;try{for(i=Array.from(document.querySelectorAll("[hook=check_reaction]")||[])[Symbol.iterator]();!(r=(l=i.next()).done);r=!0)c=l.value,n.observe(c)}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return t.OBSERVERS.push(n),[2]})}),function(e){return n.apply(this,arguments)})),r.define("hooks::tabs:switch",function(e,t){var n=!0,r=!1,o=void 0;try{for(var a,i=Array.from(document.querySelectorAll("[data-tab]"))[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)a.value.classList.add("hidden")}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}if(document.querySelector('[data-tab="'.concat(t,'"]')).classList.remove("hidden"),document.querySelector('[data-tab-button="'.concat(t,'"]'))){var l=!0,c=!1,s=void 0;try{for(var u,d=Array.from(document.querySelectorAll("[data-tab-button]"))[Symbol.iterator]();!(l=(u=d.next()).done);l=!0)u.value.classList.remove("active")}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}document.querySelector('[data-tab-button="'.concat(t,'"]')).classList.add("active")}}),r.define("hooks::tabs:check",function(e,t){var n=e.$;t&&t.startsWith("#/")&&n["hooks::tabs:switch"](t.replace("#/",""))}),r.define("hooks::tabs",function(e){var t=e.$;t["hooks::tabs:check"](window.location.hash),window.addEventListener("hashchange",function(e){return t["hooks::tabs:check"](new URL(e.newURL).hash)})}),r.define("prompt",function(e,t){var n=document.getElementById("web_api_prompt");return document.getElementById("web_api_prompt:msg").innerText=t,new Promise(function(e,t){globalThis.web_api_prompt_submit=function(t){return n.close(),e(t)},n.showModal()})}),r.define("prompt_long",function(e,t){var n=document.getElementById("web_api_prompt_long");return document.getElementById("web_api_prompt_long:msg").innerText=t,new Promise(function(e,t){globalThis.web_api_prompt_long_submit=function(t){return n.close(),e(t)},n.showModal()})}),r.define("confirm",function(e,t){var n=document.getElementById("web_api_confirm");return document.getElementById("web_api_confirm:msg").innerText=t,new Promise(function(e,t){globalThis.web_api_confirm_submit=function(t){return n.close(),e(t)},n.showModal()})}),r.define("shout",function(e,t,n){document.getElementById("admonition")&&document.getElementById("admonition").remove();var r=document.createElement("div");if(r.id="admonition",r.classList.add("markdown-alert-".concat(t)),r.innerHTML=n.replaceAll("<","&lt").replaceAll(">","&gt;"),document.querySelector("#admonition_zone")){document.querySelector("#admonition_zone").prepend(r);return}document.querySelector("article").prepend(r)});var o=function(){var e=new URLSearchParams(window.location.search);if(e.get("ANNC")){var t=e.get("ANNC_TYPE")?e.get("ANNC_TYPE"):globalThis._app_base.annc.type;r.shout(t,e.get("ANNC"))}};globalThis.annc_event=o,document.documentElement.addEventListener("turbo:load",o),document.documentElement.addEventListener("turbo:submit-end",function(e){"text/html"===e.detail.fetchResponse.response.headers.get("Content-Type")&&(window.location.href=e.detail.fetchResponse.response.url),o()}),r.define("toast",function(e,t,n){var r=e.$,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=document.createElement("div");a.id="toast",a.classList.add(t),a.classList.add("toast"),a.innerHTML="<span>".concat(n.replaceAll("<","&lt").replaceAll(">","&gt;"),"</span>"),document.getElementById("toast_zone").prepend(a);var i=document.createElement("span");a.appendChild(i),i.innerText=o,i.classList.add("timer"),setTimeout(function(){clearInterval(l),r.smooth_remove(a,500)},1e3*o);var l=setInterval(function(){o-=1,i.innerText=o},1e3)}),r.define("link_filter",function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=Array.from(document.querySelectorAll("a"))[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)!function(){var e=o.value;if(0!==e.href.length){var t=new URL(e.href);!(e.href.startsWith("/")||e.href.startsWith("javascript:"))&&t.origin!==window.location.origin&&e.addEventListener("click",function(t){t.preventDefault(),document.getElementById("link_filter_url").innerText=e.href,document.getElementById("link_filter_continue").href=e.href,document.getElementById("link_filter").showModal()})}}()}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}})}();